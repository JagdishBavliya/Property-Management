<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Estimates Export</title>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; margin: 32px 32px 48px 32px; font-size: 11px; color: #222; background: #f8fafc; }
    .header { background: linear-gradient(90deg, #2563eb 0%, #60a5fa 100%); color: #fff; padding: 18px 24px; border-radius: 12px 12px 0 0; font-size: 1.5em; font-weight: bold; letter-spacing: 1px; margin-bottom: 0; box-shadow: 0 2px 8px #0001; }
    .table-container { background: #fff; border-radius: 0 0 12px 12px; box-shadow: 0 2px 8px #0001; overflow: hidden; }
    table { width: 100%; border-collapse: collapse; table-layout: auto; word-break: break-word; }
    th, td { border: 1px solid #e5e7eb; padding: 8px 10px; text-align: left; font-size: 11px; }
    th { background: #f1f5f9; color: #2563eb; font-weight: bold; }
    tr:nth-child(even) td { background: #f9fafb; }
    tr:hover td { background: #e0e7ef; }
    td { max-width: 120px; overflow-wrap: break-word; }
    .status-cell { font-weight: bold; border-radius: 4px; padding: 6px 10px; color: #fff; background: #64748b; }
    .status-Approved { background: #22c55e !important; }
    .status-Rejected { background: #ef4444 !important; }
    .status-Draft { background: #f59e0b !important; }
    .status-Sent { background: #3b82f6 !important; }
    .status-Expired { background: #6366f1 !important; }
    .footer { font-size: 10px; color: #888; text-align: right; margin-top: 24px; }
  </style>
</head>
<body>
  <div class="header">Estimates Export</div>
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Prop Code</th>
          <th>Agent</th>
          <th>Size</th>
          <th>Rate</th>
          <th>Brkr Seller</th>
          <th>Brkr Buyer</th>
          <th>Addl Costs</th>
          <th>Total</th>
          <th>Brkr Total</th>
          <th>Created</th>
          <th>Type</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <% estimates.forEach(row => { %>
          <tr>
            <td><%= row.id || ' - ' %></td>
            <td><%= row.property_code || ' - ' %></td>
            <td><%= row.agent_code || ' - ' %></td>
            <td><%= row.property_size || ' - ' %></td>
            <td><%= row.property_rate || ' - ' %></td>
            <td><%= row.brokerage_seller || ' - ' %></td>
            <td><%= row.brokerage_buyer || ' - ' %></td>
            <td><%= row.additional_costs || ' - ' %></td>
            <td><%= row.total || ' - ' %></td>
            <td><%= row.total_brokerage || ' - ' %></td>
            <td><%= row.created_at ? new Date(row.created_at).toLocaleString() : '' || ' - ' %></td>
            <td>Estimate</td>
            <td class="status-cell status-<%= row.status %>"><%= row.status || 'N/A'|| ' - ' %></td>
          </tr>
        <% }); %>
      </tbody>
    </table>
  </div>
  <div class="footer">Exported on <%= new Date().toLocaleString('en-IN') %></div>
</body>
</html>